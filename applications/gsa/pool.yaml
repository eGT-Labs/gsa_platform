  - name: server
    min-size: 2
    max-size: 2
    wait-for-nodes: 1
    sync_siblings: true
    run_list:
    - recipe[ecap-glusterfs]
    - recipe[ecap-glusterfs::server]
    vpc:
      vpc_name: vpc
      nat_host_name: bastion
      nat_ssh_user: root
      subnets:
<%
azs = ECAP::Deploy.listAZs
(1..azs.size).each do |netnum|
%>
      - subnet_name: PrivateSubnet<%= netnum %>
<% end %>
    ingress_rules:
    - port-range: 24007-24008
      hosts:
      - 10.0.0.0/8
    - port-range: 49152-49160
      hosts:
      - 10.0.0.0/8
    basis:
      launch-config:
        name: gluster
        size: t2.medium
        <%= ECAP::Config.include('/centos-ami.yaml') %>
        storage:
        - device: "/dev/xvdf"
          size: 100
        - device: "/dev/xvdg"
          size: 100
